<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="shortcut icon" type="image/x-icon" href="./images/favicon (4).ico">
    

    <title>The Tailor of Gloucester</title>

    <style>
      @import url("https://fonts.googleapis.com/css?family=Stalemate");
      *,
      *:before,
      *:after {
        box-sizing: border-box;
      }

      img {
        max-width: 100%;
      }

      body {
        /*   background:  linear-gradient(
      rgba(255, 250, 250, 0.75), 
      rgba(255, 250, 250, 0.75)), url(https://image.freepik.com/free-vector/forest-herbs-blue-background_8365-70.jpg); */
        /*     background:     linear-gradient(
      rgba(255, 250, 250, 0.75), 
      rgba(255, 250, 250, 0.75)
    ), url(https://i.pinimg.com/736x/3c/c0/54/3cc0541a55ce0550f78246bed0a96380--vintage-floral-backgrounds-vintage-wallpapers.jpg); */
        background: url(wood.jpg);
        font-family: "Stalemate", cursive;
        filter: brightness(1.25);
        width: 100vw;
        height: 100vh;
      }

      .container {
        overflow: hidden;
        margin-top: 3%;
        width: 100vw;
        height: 100vh;
      }
      .book-wrapper {
        position: relative;
        margin-top: auto;
        margin-left: 15%;
        margin-right: auto;
        margin-bottom: auto;
      }

      .book-wrapper img {
        filter: drop-shadow(15px 5px 5px #494338);
      }
      .pages-container {
        position: absolute;
        top: 0.1%;
        left: 0.5%;
        right: 0;
        bottom: 0.1%;
        width: 91.5%;
        height: 91%;
      }

      
      
      .pages [class^="page-num-"] {
        background-image: url("Old Book Page 2.png");
        background-size: auto 100%;
        position: relative;
      }

      .pages-content {
        text-align: center;
        position: absolute;
        width: 100%;
        height: 100%;
        display: table;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        padding: 10%;
      }

      .content-inner {
        text-align: center;
        display: table-cell;
        vertical-align: middle;
      }

      .book-wrapper {
        user-select: none;
      }

      .page-num-1 .pages-background {
        background: url(Old\ Book\ Page\ 2.png);
        background-size: cover;
        opacity: 0.2;
        width: 100%;
        height: 100%;
        position: absolute;
        left: 0;
        top: 0;
      }
      .text {
        font-size: 2.5rem;
        line-height: 2.5rem;
      }
      h2 {
        font-size: 5rem;
        font-weight: bold;
      }
      .back{
        position: absolute; 
        width: 14vw; 
        border: 5px solid #996515; 
        box-shadow: 5px 5px 15px 5px #000000;
      }

      .back:hover{
        filter: brightness(110%) saturate(140%);
      }
    </style>

    <script>
      window.console = window.console || function (t) {};
    </script>

    <script>
      if (document.location.search.match(/type=embed/gi)) {
        window.parent.postMessage("resize", "*");
      }
    </script>
  </head>
  <div class="back">
  <a href="index.html"><img src="Advent_calendar.png"></a>
  </div>

  <body translate="no">
    <div class="container">
      <div class="book-wrapper">
        <div class="book-cover">
          <img src="bookcover copy.jpeg" alt="" style="width: 1000px" />
        </div>
        <div class="pages-container">
          <div class="pages">
            <div class="page-num-1">
              <div class="pages-content">
                <div class="pages-background"></div>
                <div class="content-inner">
                  <h1 style="font-size: 3rem;">The Tailor of Gloucester</h1>
                  <img
                    src="./Tailor/I1.jpeg"
                    alt="The Tailor"
                    style="width: 25vh"
                  />
                  <div class="text">
                    <p>
                      The time of swords and periwigs and full-skirted coats
                      with flowered lappets, when gentlemen wore ruffles, and
                      gold-laced waistcoats of silk and taffeta there lived a
                      tailor in Gloucester.
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-2">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>
                      He sat in the window of a little shop in Westgate Street,
                      cross-legged on a table, from morning till dark.
                    </p>
                    <p>
                      All day long while the light lasted he sewed and
                      snippeted, piecing out his satin and pompadour, and
                      lutestring; stuffs had strange names, and were very
                      expensive in the days of the Tailor of Gloucester.
                    </p>
                    <p>
                      But although he sewed fine silk for his neighbours, he
                      himself was very, very poor, a little old man in
                      spectacles, with a pinched face, old crooked fingers, and
                      a suit of thread-bare clothes.
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-3">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>
                      He cut his coats without waste, according to his
                      embroidered cloth; they were very small ends and snippets
                      that lay about upon the table. "Too narrow breadths for
                      nothing except waistcoats for mice," said the tailor.
                    </p>
                    <img
                      src="./Tailor/I2.jpeg"
                      alt="Waistcoats for mice"
                      style="width: 40vh"
                    />
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-4">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>
                      On a bitter cold day near Christmastime the tailor began
                      to make a coat, a coat of cherry-coloured corded silk
                      embroidered with pansies and roses, and a cream coloured
                      satin waistcoat trimmed with gauze and green worsted
                      chenille, for the Mayor of Gloucester.
                    </p>
                    <img
                      src="./Tailor/I3.jpeg"
                      alt="A well dressed Miss"
                      style="width: 25vh"
                    />
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-5">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>
                      The tailor worked and worked, and he talked to himself. He
                      measured the silk, and turned it round and round, and
                      trimmed it into shape with his shears; the table was all
                      littered with cherry-coloured snippets.
                    </p>
                    <p>
                      "No breadth at all, and cut on the cross; it is no breadth
                      at all; tippets for mice and ribbons for mobs! for mice!"
                      said the Tailor of Gloucester.
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-6">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <img
                      src="./Tailor/I5.jpeg"
                      alt="The tailor leaves the shop"
                      style="width: 30vh"
                    />
                    <p>
                      When the snow-flakes came down against the small leaded
                      window-panes and shut out the light, the tailor had done
                      his day's work; all the silk and satin lay cut out upon
                      the table.
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-7">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>
                      There were twelve pieces for the coat and four pieces for
                      the waistcoat; and there were pocket flaps and cuffs, and
                      buttons all in order. For the lining of the coat there was
                      fine yellow taffeta; and for the button-holes of the
                      waistcoat, there was cherry-coloured twist. And everything
                      was ready to sew together in the morning, all measured and
                      sufficient--except that there was wanting just one single
                      piece of cherry-coloured twisted silk.
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-8">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>
                      The tailor came out of his shop at dark, for he did not
                      sleep there at nights; he fastened the window and locked
                      the door, and took away the key. No one lived there at
                      night but little brown mice, and they run in and out
                      without any keys!
                    </p>
                    <img
                      src="./Tailor/I6.jpeg"
                      alt="Down the street"
                      style="width: 30vh"
                    />
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-9">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>
                      For behind the wooden skirting-boards of all the old
                      houses in Gloucester, there are little mouse staircases
                      and secret trap-doors; and the mice run from house to
                      house through those long narrow passages; they can run all
                      over the town without going into the streets.
                    </p>
                    <p>
                      But the tailor came out of his shop, and shuffled home
                      through the snow. He lived quite near by in College Court,
                      next to the doorway to College Green; and although it was
                      not a big house, the tailor was so poor he only rented the
                      kitchen.
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-10">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>He lived alone with his cat; it was called Simpkin.</p>
                    <img
                      src="./Tailor/I7.jpeg"
                      alt="His cat Simkin"
                      style="width: 25vh"
                    />
                    <p>
                      All day long while the tailor was out at work, Simpkin
                      kept house by himself; and he also was fond of the mice,
                      though he gave them no satin for coats!
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-11">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>
                      "Miow?" said the cat when the tailor opened the door,
                      "Miow?"
                    </p>
                    <p>
                      The tailor replied--"Simpkin, we shall make our fortune,
                      but I am worn to a ravelling. Take this groat (which is
                      our last fourpence) and Simpkin, take a china pot; buy a
                      pennyworth of bread, a pennyworth of milk and a pennyworth
                      of sausages. And oh, Simpkin, with the last penny of our
                      fourpence buy me one pennyworth of cherry-coloured silk.
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-12">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>
                      But do not lose the last penny of the fourpence, Simpkin,
                      or I am undone and worn to a thread-paper, for...
                      <br /><br />
                      I have NO MORE TWIST."
                    </p>
                    <img
                      src="./Tailor/I8.jpeg"
                      alt="Asleep in front of the fire"
                      style="width: 30vh"
                    />
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-13">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>
                      Simpkin again said, "Miow?" and took the groat and the
                      pot, and went out into the dark.
                    </p>
                    <p>
                      The tailor was very tired and beginning to be ill. He sat
                      down by the hearth and talked to himself about that
                      wonderful coat.
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-14">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>
                      "I shall make my fortune, the Mayor of Gloucester is to be
                      married on Christmas Day in the morning, and he has
                      ordered a coat and an embroidered waistcoat, to be lined
                      with yellow taffeta but the taffeta is not enough; there
                      is no more left over in snippets than will serve to make
                      tippets for mice"
                    </p>
                    <p>
                      Then the tailor started; for suddenly, interrupting him,
                      from the dresser at the other side of the kitchen came a
                      number of little noises-- <br />

                      Tip tap, tip tap, tip tap tip!
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-15">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>
                      "This is very peculiar," said the Tailor of Gloucester;
                      and he lifted up the tea-cup which was upside down.
                    </p>
                    <img
                      src="./Tailor/I9.jpeg"
                      alt="Asleep in front of the fire"
                      style="width: 30vh"
                    />
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-16">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>
                      Out stepped a little live lady mouse, and made a curtsey
                      to the tailor! Then she hopped away down off the dresser,
                      and under the skirting-board.
                    </p>
                    <p>
                      The tailor sat down again by the fire, warming his poor
                      cold hands, and mumbling to himself.
                    </p>

                    <p>
                      "The waistcoat is cut out from peach-coloured satin
                      tambour stitch and rose-buds in beautiful floss silk. Was
                      I wise to entrust my last fourpence to Simpkin?
                      One-and-twenty button-holes of cherry-coloured twist!"
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-17">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>
                      But all at once, from the dresser, there came other little
                      noises:
                    </p>
                    <p>Tip tap, tip tap, tip tap tip!</p>
                    <p>
                      "This is passing extraordinary!" said the Tailor of
                      Gloucester, and turned over another tea-cup, which was
                      upside down.
                    </p>
                    <img
                      src="./Tailor/I10.jpeg"
                      alt="Asleep in front of the fire"
                      style="width: 20vh"
                    />
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-18">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>
                      Out stepped a little gentleman mouse, and made a bow to
                      the tailor!
                    </p>
                    <p>
                      And then from all over the dresser came a chorus of little
                      tappings, all sounding together, and answering one
                      another, like watch-beetles in an old worm-eaten
                      window-shutter.
                    </p>
                    <p>Tip tap, tip tap, tip tap tip!</p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-19">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>
                      And out from under tea-cups and from under bowls and
                      basins, stepped other and more little mice who hopped away
                      down off the dresser and under the skirting-board.
                    </p>
                    <img
                      src="./Tailor/I11.jpeg"
                      alt="Asleep in front of the fire"
                      style="width: 30vh"
                    />
                    <p></p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-20">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>
                      The tailor sat down, close over the fire,
                      lamenting--"One-and-twenty button-holes of cherry-coloured
                      silk! To be finished by noon of Saturday: and this is
                      Tuesday evening. Was it right to let loose those mice,
                      undoubtedly the property of Simpkin? Alack, I am undone,
                      for I have no more twist!"
                    </p>
                    <p>
                      The little mice came out again, and listened to the
                      tailor; they took notice of the pattern of that wonderful
                      coat. They whispered to one another about the taffeta
                      lining, and about little mouse tippets.
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-21">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>
                      And then all at once they all ran away together down the
                      passage behind the skirting-board, squeaking and calling
                      to one another, as they ran from house to house; and not
                      one mouse was left in the tailor's kitchen when Simpkin
                      came back with the pot of milk!
                    </p>
                    <img
                      src="./Tailor/I12.jpeg"
                      alt="Asleep in front of the fire"
                      style="width: 25vh"
                    />
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-22">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>
                      Simpkin opened the door and bounced in, with an angry
                      "G-r-r-miaw!" like a cat that is vexed: for he hated the
                      snow, and there was snow in his ears, and snow in his
                      collar at the back of his neck. He put down the loaf and
                      the sausages upon the dresser, and sniffed.
                    </p>
                    <p>
                      "Simpkin," said the tailor, "where is my twist?"
                      <br /><br />But Simpkin set down the pot of milk upon the
                      dresser, and looked suspiciously at the tea-cups. He
                      wanted his supper of little fat mouse!
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-23">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>"Simpkin," said the tailor, "where is my TWIST?"</p>
                    <img
                      src="./Tailor/I13.jpeg"
                      alt="Asleep in front of the fire"
                      style="width: 25vh"
                    />
                    <p>
                      But Simpkin hid a little parcel privately in the tea-pot,
                      and spit and growled at the tailor; and if Simpkin had
                      been able to talk, he would have asked: "Where is my
                      MOUSE?"
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-24">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>
                      "Alas, I am undone!" said the Tailor of Gloucester, and
                      went sadly to bed.
                    </p>
                    <p>
                      All that night long Simpkin hunted and searched through
                      the kitchen, peeping into cupboards and under the
                      skirting-board, and into the tea-pot where he had hidden
                      that twist; but still he found never a mouse!
                    </p>
                    <p>
                      Whenever the tailor muttered and talked in his sleep,
                      Simpkin said "Miaw-ger-r-w-s-s-ch!" and made strange
                      horrid noises, as cats do at night.
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-25">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <img
                      src="./Tailor/I14.jpeg"
                      alt="Asleep in front of the fire"
                      style="width: 25vh"
                    />
                    <p>
                      For the poor old tailor was very ill with a fever, tossing
                      and turning in his four-post bed; and still in his dreams
                      he mumbled--"No more twist! no more twist!"
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-26">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>
                      All that day he was ill, and the next day, and the next;
                      and what should become of the cherry-coloured coat? In the
                      tailor's shop in Westgate Street the embroidered silk and
                      satin lay cut out upon the table--one-and-twenty
                      button-holes--and who should come to sew them, when the
                      window was barred, and the door was fast locked?
                    </p>
                    <p>
                      But that does not hinder the little brown mice; they run
                      in and out without any keys through all the old houses in
                      Gloucester!
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-27">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <img
                      src="./Tailor/I15.jpeg"
                      alt="Asleep in front of the fire"
                      style="width: 30vh"
                    />
                    <p>
                      Out of doors the market folks went trudging through the
                      snow to buy their geese and turkeys, and to bake their
                      Christmas pies; but there would be no Christmas dinner for
                      Simpkin and the poor old Tailor of Gloucester.
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-28">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>
                      The tailor lay ill for three days and nights; and then it
                      was Christmas Eve, and very late at night. The moon
                      climbed up over the roof-tops and chimneys, and looked
                      down over the gateway into College Court. There were no
                      lights in the windows, nor any sound in the houses; all
                      the city of Gloucester was fast asleep under the snow.
                    </p>
                    <p>
                      And still Simpkin wanted his mice, and he mewed as he
                      stood beside the four-post bed.
                    </p>

                    <p></p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-29">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <img
                      src="./Tailor/I16.jpeg"
                      alt="Asleep in front of the fire"
                      style="width: 30vh"
                    />
                    <p>
                      But it is in the old stories that all the beasts can talk,
                      in the night between Christmas Eve and Christmas Day in
                      the morning (though there are very few folk that can hear
                      them, or know what it is that they say).
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-30">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>
                      When the Cathedral clock struck twelve there was an
                      answer, like an echo of the chimes, and Simpkin heard it,
                      and came out of the tailor's door, and wandered about in
                      the snow.
                    </p>
                    <p>
                      From all the roof-tops and gables and old wooden houses in
                      Gloucester came a thousand merry voices singing the old
                      Christmas rhymes, all the old songs that ever I heard of,
                      and some that I don't know, like Whittington's bells.
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-31">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <img
                      src="./Tailor/I17.jpeg"
                      alt="Asleep in front of the fire"
                      style="width: 25vh"
                    />
                    <p>
                      First and loudest the cocks cried out: "Dame, get up, and
                      bake your pies!"
                    </p>
                    <p>"Oh, dilly, dilly, dilly!" sighed Simpkin.</p>
                    <p>
                      And now in a garret there were lights and sounds of
                      dancing, and cats came from over the way.
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-32">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>
                      "Hey, diddle, diddle, the cat and the fiddle! All the cats
                      in Gloucester except me," said Simpkin.
                    </p>
                    <p>
                      Under the wooden eaves the starlings and sparrows sang of
                      Christmas pies; the jack-daws woke up in the Cathedral
                      tower; and although it was the middle of the night the
                      throstles and robins sang; the air was quite full of
                      little twittering tunes.
                    </p>
                    <p>
                      But it was all rather provoking to poor hungry Simpkin!
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-33">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <img
                      src="./Tailor/I18.jpeg"
                      alt="Asleep in front of the fire"
                      style="width: 25vh"
                    />

                    <p>
                      Particularly he was vexed with some little shrill voices
                      from behind a wooden lattice. I think that they were bats,
                      because they always have very small voices, especially in
                      a black frost, when they talk in their sleep, like the
                      Tailor of Gloucester.
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-34">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>They said something mysterious that sounded like,</p>
                    <p>
                      "Buz, quoth the blue fly, hum, quoth the bee, Buz and hum
                      they cry, and so do we!"
                    </p>

                    <p>
                      and Simpkin went away shaking his ears as if he had a bee
                      in his bonnet.
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-35">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <img
                      src="./Tailor/I19.jpeg"
                      alt="Asleep in front of the fire"
                      style="width: 25vh"
                    />
                    <p>
                      From the tailor's shop in Westgate came a glow of light;
                      and when Simpkin crept up to peep in at the window it was
                      full of candles. There was a snippeting of scissors, and
                      snappeting of thread; and little mouse voices sang loudly
                      and gaily,
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-36">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>
                      "Four-and-twenty tailors <br />
                      Went to catch a snail, <br />
                      The best man amongst them <br />
                      Durst not touch her tail, <br />
                      She put out her horns <br />
                      Like a little kyloe cow, <br />
                      Run, tailors, run! or she'll have you all e'en now!"
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-37">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>
                      Then without a pause the little mouse voices went on
                      again,
                    </p>
                    <p>
                      "Sieve my lady's oatmeal, <br />
                      Grind my lady's flour, <br />
                      Put it in a chestnut, <br />
                      Let it stand an hour"
                    </p>
                    <img
                      src="./Tailor/I20.jpeg"
                      alt="Asleep in front of the fire"
                      style="width: 30vh"
                    />
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-38">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>"Mew! Mew!" interrupted Simpkin, and he scratched at the door. But the
                        key was under the tailor's pillow, he could not get in.</p>
                    <p>The little mice only laughed, and tried another tune,</p>
                    <p>"Three little mice sat down to spin, <br>
                        Pussy passed by and she peeped in. <br>
                        What are you at, my fine little men? <br>
                        Making coats for gentlemen. <br>
                        </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-39">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>Shall I come in and cut off your threads? <br>
                        Oh, no, Miss Pussy, you'd bite off our heads!"</p>
                    <p>"Mew! Mew!" cried Simpkin. "Hey diddle dinketty?" answered the little
                        mice,</p>
                        <p>
                            "Hey diddle dinketty, poppetty pet! <br>
                                     The merchants of London they wear scarlet; <br>
                                     Silk in the collar, and gold in the hem, <br>
                                     So merrily march the merchantmen!"
                        </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-40">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <img src="./Tailor/I21.jpeg" alt="Asleep in front of the fire" style="width: 30vh;">
                    <p>They clicked their thimbles to mark the time, but none of the songs
                        pleased Simpkin; he sniffed and mewed at the door of the shop.</p>
                    <p>"And then I bought <br>
                        A pipkin and a popkin, <br>
                        A slipkin and a slopkin, <br>
                        All for one farthing</p>
                    <p></p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-41">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>and upon the kitchen dresser!" added the rude little mice.</p>
                    <p>"Mew! scratch! scratch!" scuffled Simpkin on the window-sill; while the
                        little mice inside sprang to their feet, and all began to shout at once in
                        little twittering voices: "No more twist! No more twist!" And they barred
                        up the window shutters and shut out Simpkin.</p>
                        <p>
                            But still through the nicks in the shutters he could hear the click of
                                thimbles, and little mouse voices singing.
                        </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-42">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <img src="./Tailor/I22.jpeg" alt="Asleep in front of the fire" style="width: 30vh;">
                    <p>"No more twist! No more twist!"</p>
                    <p>Simpkin came away from the shop and went home, considering in his mind. He
                        found the poor old tailor without fever, sleeping peacefully.</p>
                        
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-43">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <p>
                            Then Simpkin went on tip-toe and took a little parcel of silk out of the
                                tea-pot, and looked at it in the moonlight; and he felt quite ashamed of
                                his badness compared with those good little mice!
                        </p>
                        <p>When the tailor awoke in the morning, the first thing which he saw upon
                            the patchwork quilt, was a skein of cherry-coloured twisted silk, and
                            beside his bed stood the repentant Simpkin!</p>
                    
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-44">
              <div class="pages-content">
                <div class="content-inner">
                  <div class="text">
                    <img src="./Tailor/I23.jpeg" alt="Asleep in front of the fire" style="width: 25vh;">
                    <p>"Alas, I am worn to a ravelling," said the Tailor of Gloucester, "but I
                        have my twist!"</p>
                    <p>The sun was shining on the snow when the tailor got up and dressed, and
                        came out into the street with Simpkin running before him.</p>
                  </div>
                </div>
              </div>
            </div>
            <div class="page-num-45">
                <div class="pages-content">
                  <div class="content-inner">
                    <div class="text">
                      <p>The starlings whistled on the chimney stacks, and the throstles and robins
                        sang, but they sang their own little noises, not the words they had sung
                        in the night.</p>
                      <p>"Alas," said the tailor, "I have my twist; but no more strength, nor
                        time, than will serve to make me one single button-hole; for this is
                        Christmas Day in the Morning! The Mayor of Gloucester shall be married by
                        noon and where is his cherry-coloured coat?"</p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="page-num-46">
                <div class="pages-content">
                  <div class="content-inner">
                    <div class="text">
                      <p>He unlocked the door of the little shop in Westgate Street, and Simpkin
                        ran in, like a cat that expects something.</p>
                      <p>But there was no one there! Not even one little brown mouse!</p>
                      <p>The boards were swept clean; the little ends of thread and the little silk
                        snippets were all tidied away, and gone from off the floor.</p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="page-num-47">
                <div class="pages-content">
                  <div class="content-inner">
                    <div class="text">
                      <p>But upon the table, oh joy! the tailor gave a shout, there, where he had
                        left plain cuttings of silk there lay the most beautifull coat and
                        embroidered satin waistcoat that ever were worn by a Mayor of Gloucester.</p>
                        <img src="./Tailor/I24.jpeg" alt="Asleep in front of the fire" style="width: 30vh;">
                    </div>
                  </div>
                </div>
              </div>
              <div class="page-num-48">
                <div class="pages-content">
                  <div class="content-inner">
                    <div class="text">
                      <p>There were roses and pansies upon the facings of the coat; and the
                        waistcoat was worked with poppies and corn-flowers.</p>
                        <img src="./Tailor/I25.jpeg" alt="Asleep in front of the fire" style="width: 30vh;">
                      <p></p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="page-num-49">
                <div class="pages-content">
                  <div class="content-inner">
                    <div class="text">
                      <p>Everything was finished except just one single cherry-coloured
                        button-hole, and where that button-hole was wanting there was pinned a
                        scrap of paper with these words--in little teeny weeny writing,</p>
                      <p>NO MORE TWIST</p>
                      <p>
                        And from that day onwards began the luck of the Tailor of Gloucester; he grew quite
                        stout, and he grew quite rich.
                      </p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="page-num-50">
                <div class="pages-content">
                  <div class="content-inner">
                    <div class="text">
                      <p>He made the most wonderful waistcoats for all the rich merchants of
                        Gloucester, and for all the fine gentlemen of the country round.</p>
                        <img src="./Tailor/I26.jpeg" alt="Asleep in front of the fire" style="width: 30vh;">
                      
                    </div>
                  </div>
                </div>
              </div>
              <div class="page-num-51">
                <div class="pages-content">
                  <div class="content-inner">
                    <div class="text">
                      <p>Never were seen such ruffles, or such embroidered cuffs and lappets! But
                        his button-holes were the greatest triumph of it all.</p>
                        <p>The stitches of those button-holes were so neat, so neat! I wonder how
                            they could be stitched by an old man in spectacles, with crooked old
                            fingers, and a tailor's thimble.</p>
                      <p>The stitches of those button-holes were so small, so small, they looked
                        as if they had been made by little mice!</p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="page-num-52">
                <div class="pages-content">
                  <div class="content-inner">
                    <div class="text">
                      <p></p>
                      <h1 style="font-size: 5rem; color: black;">The End</h1>
                      <p></p>
                    </div>
                  </div>
                </div>
              </div>
            <div class="page-num-53">
              <div class="pages-content">
                <div class="content-inner">
                  
                  <img class="line" src="decorative-line-transparent-9.png" alt="line">
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cpwebassets.codepen.io/assets/common/stopExecutionOnTimeout-1b93190375e9ccc259df3a57c1abc0e64599724ae30d7ea4c6877eb615f89387.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.20.3/TweenMax.min.js"></script>
    <script id="rendered-js">
      (function ($) {
        "use strict";

        var has3d,
          hasRot,
          vendor = "",
          version = "4.1.0",
          PI = Math.PI,
          A90 = PI / 2,
          isTouch = "ontouchstart" in window,
          mouseEvents = isTouch
            ? {
                down: "touchstart",
                move: "touchmove",
                up: "touchend",
                over: "touchstart",
                out: "touchend",
              }
            : {
                down: "mousedown",
                move: "mousemove",
                up: "mouseup",
                over: "mouseover",
                out: "mouseout",
              },
          // Constants used for each corner
          //   | tl * tr |
          // l | *     * | r
          //   | bl * br |

          corners = {
            backward: ["bl", "tl"],
            forward: ["br", "tr"],
            all: ["tl", "bl", "tr", "br", "l", "r"],
          },
          // Display values

          displays = ["single", "double"],
          // Direction values

          directions = ["ltr", "rtl"],
          // Default options

          turnOptions = {
            // Enables hardware acceleration

            acceleration: true,

            // Display

            display: "double",

            // Duration of transition in milliseconds

            duration: 600,

            // First page

            page: 1,

            // Enables gradients

            gradients: true,

            // Corners used when turning the page

            turnCorners: "bl,br",

            // Events

            when: null,
          },
          flipOptions = {
            // Size of the active zone of each corner

            cornerSize: 100,
          },
          // Number of pages in the DOM, minimum value: 6

          pagesInDOM = 6,
          turnMethods = {
            // Singleton constructor
            // $('#selector').turn([options]);

            init: function (options) {
              // Define constants

              has3d =
                "WebKitCSSMatrix" in window ||
                "MozPerspective" in document.body.style;
              hasRot = rotationAvailable();
              vendor = getPrefix();

              var i,
                that = this,
                pageNum = 0,
                data = this.data(),
                ch = this.children();

              // Set initial configuration

              options = $.extend(
                {
                  width: this.width(),
                  height: this.height(),
                  direction: this.attr("dir") || this.css("direction") || "ltr",
                },
                turnOptions,
                options
              );

              data.opts = options;
              data.pageObjs = {};
              data.pages = {};
              data.pageWrap = {};
              data.pageZoom = {};
              data.pagePlace = {};
              data.pageMv = [];
              data.zoom = 1;
              data.totalPages = options.pages || 0;
              data.eventHandlers = {
                touchStart: $.proxy(turnMethods._touchStart, this),
                touchMove: $.proxy(turnMethods._touchMove, this),
                touchEnd: $.proxy(turnMethods._touchEnd, this),
                start: $.proxy(turnMethods._eventStart, this),
              };

              // Add event listeners

              if (options.when)
                for (i in options.when)
                  if (has(i, options.when)) this.bind(i, options.when[i]);

              // Set the css

              this.css({
                position: "relative",
                width: options.width,
                height: options.height,
              });

              // Set the initial display

              this.turn("display", options.display);

              // Set the direction

              if (options.direction !== "")
                this.turn("direction", options.direction);

              // Prevent blue screen problems of switching to hardware acceleration mode
              // By forcing hardware acceleration for ever

              if (has3d && !isTouch && options.acceleration)
                this.transform(translate(0, 0, true));

              // Add pages from the DOM

              for (i = 0; i < ch.length; i++) {
                if ($(ch[i]).attr("ignore") != "1") {
                  this.turn("addPage", ch[i], ++pageNum);
                }
              }

              // Event listeners

              $(this)
                .bind(mouseEvents.down, data.eventHandlers.touchStart)
                .bind("end", turnMethods._eventEnd)
                .bind("pressed", turnMethods._eventPressed)
                .bind("released", turnMethods._eventReleased)
                .bind("flip", turnMethods._flip);

              $(this).parent().bind("start", data.eventHandlers.start);

              $(document)
                .bind(mouseEvents.move, data.eventHandlers.touchMove)
                .bind(mouseEvents.up, data.eventHandlers.touchEnd);

              // Set the initial page

              this.turn("page", options.page);

              // This flipbook is ready

              data.done = true;

              return this;
            },

            // Adds a page from external data

            addPage: function (element, page) {
              var currentPage,
                className,
                incPages = false,
                data = this.data(),
                lastPage = data.totalPages + 1;

              if (data.destroying) return false;

              // Read the page number from the className of `element` - format: p[0-9]+

              if (
                (currentPage = /\bp([0-9]+)\b/.exec($(element).attr("class")))
              )
                page = parseInt(currentPage[1], 10);

              if (page) {
                if (page == lastPage) incPages = true;
                else if (page > lastPage)
                  throw turnError('Page "' + page + '" cannot be inserted');
              } else {
                page = lastPage;
                incPages = true;
              }

              if (page >= 1 && page <= lastPage) {
                if (data.display == "double")
                  className = page % 2 ? " odd" : " even";
                else className = "";

                // Stop animations
                if (data.done) this.turn("stop");

                // Move pages if it's necessary
                if (page in data.pageObjs)
                  turnMethods._movePages.call(this, page, 1);

                // Increase the number of pages
                if (incPages) data.totalPages = lastPage;

                // Add element
                data.pageObjs[page] = $(element)
                  .css({ float: "left" })
                  .addClass("page p" + page + className);

                if (!hasHardPage() && data.pageObjs[page].hasClass("hard")) {
                  data.pageObjs[page].removeClass("hard");
                }

                // Add page
                turnMethods._addPage.call(this, page);

                // Remove pages out of range
                turnMethods._removeFromDOM.call(this);
              }

              return this;
            },

            // Adds a page

            _addPage: function (page) {
              var data = this.data(),
                element = data.pageObjs[page];

              if (element)
                if (turnMethods._necessPage.call(this, page)) {
                  if (!data.pageWrap[page]) {
                    // Wrapper
                    data.pageWrap[page] = $("<div/>", {
                      class: "page-wrapper",
                      page: page,
                      css: { position: "absolute", overflow: "hidden" },
                    });

                    // Append to this flipbook
                    this.append(data.pageWrap[page]);

                    if (!data.pagePlace[page]) {
                      data.pagePlace[page] = page;
                      // Move `pageObjs[page]` to wrapper
                      data.pageObjs[page].appendTo(data.pageWrap[page]);
                    }

                    // Set the size of the page
                    var prop = turnMethods._pageSize.call(this, page, true);
                    element.css({ width: prop.width, height: prop.height });
                    data.pageWrap[page].css(prop);
                  }

                  if (data.pagePlace[page] == page) {
                    // If the page isn't in another place, create the flip effect
                    turnMethods._makeFlip.call(this, page);
                  }
                } else {
                  // Place
                  data.pagePlace[page] = 0;

                  // Remove element from the DOM
                  if (data.pageObjs[page]) data.pageObjs[page].remove();
                }
            },

            // Checks if a page is in memory

            hasPage: function (page) {
              return has(page, this.data().pageObjs);
            },

            // Centers the flipbook

            center: function (page) {
              var data = this.data(),
                size = $(this).turn("size"),
                left = 0;

              if (!data.noCenter) {
                if (data.display == "double") {
                  var view = this.turn("view", page || data.tpage || data.page);

                  if (data.direction == "ltr") {
                    if (!view[0]) left -= size.width / 4;
                    else if (!view[1]) left += size.width / 4;
                  } else {
                    if (!view[0]) left += size.width / 4;
                    else if (!view[1]) left -= size.width / 4;
                  }
                }

                $(this).css({ marginLeft: left });
              }

              return this;
            },

            // Destroys the flipbook

            destroy: function () {
              var page,
                flipbook = this,
                data = this.data(),
                events = [
                  "end",
                  "first",
                  "flip",
                  "last",
                  "pressed",
                  "released",
                  "start",
                  "turning",
                  "turned",
                  "zooming",
                  "missing",
                ];

              if (trigger("destroying", this) == "prevented") return;

              data.destroying = true;

              $.each(events, function (index, eventName) {
                flipbook.unbind(eventName);
              });

              this.parent().unbind("start", data.eventHandlers.start);

              $(document)
                .unbind(mouseEvents.move, data.eventHandlers.touchMove)
                .unbind(mouseEvents.up, data.eventHandlers.touchEnd);

              while (data.totalPages !== 0) {
                this.turn("removePage", data.totalPages);
              }

              if (data.fparent) data.fparent.remove();

              if (data.shadow) data.shadow.remove();

              this.removeData();
              data = null;

              return this;
            },

            // Checks if this element is a flipbook

            is: function () {
              return typeof this.data().pages == "object";
            },

            // Sets and gets the zoom value

            zoom: function (newZoom) {
              var data = this.data();

              if (typeof newZoom == "number") {
                if (newZoom < 0.001 || newZoom > 100)
                  throw turnError(newZoom + " is not a value for zoom");

                if (
                  trigger("zooming", this, [newZoom, data.zoom]) == "prevented"
                )
                  return this;

                var size = this.turn("size"),
                  currentView = this.turn("view"),
                  iz = 1 / data.zoom,
                  newWidth = Math.round(size.width * iz * newZoom),
                  newHeight = Math.round(size.height * iz * newZoom);

                data.zoom = newZoom;

                $(this).turn("stop").turn("size", newWidth, newHeight);
                /*.
        css({marginTop: size.height * iz / 2 - newHeight / 2});*/

                if (data.opts.autoCenter) this.turn("center");
                /*else
          $(this).css({marginLeft: size.width * iz / 2 - newWidth / 2});*/

                turnMethods._updateShadow.call(this);

                for (var i = 0; i < currentView.length; i++) {
                  if (
                    currentView[i] &&
                    data.pageZoom[currentView[i]] != data.zoom
                  ) {
                    this.trigger("zoomed", [
                      currentView[i],
                      currentView,
                      data.pageZoom[currentView[i]],
                      data.zoom,
                    ]);

                    data.pageZoom[currentView[i]] = data.zoom;
                  }
                }

                return this;
              } else return data.zoom;
            },

            // Gets the size of a page

            _pageSize: function (page, position) {
              var data = this.data(),
                prop = {};

              if (data.display == "single") {
                prop.width = this.width();
                prop.height = this.height();

                if (position) {
                  prop.top = 0;
                  prop.left = 0;
                  prop.right = "auto";
                }
              } else {
                var pageWidth = this.width() / 2,
                  pageHeight = this.height();

                if (data.pageObjs[page].hasClass("own-size")) {
                  prop.width = data.pageObjs[page].width();
                  prop.height = data.pageObjs[page].height();
                } else {
                  prop.width = pageWidth;
                  prop.height = pageHeight;
                }

                if (position) {
                  var odd = page % 2;
                  prop.top = (pageHeight - prop.height) / 2;

                  if (data.direction == "ltr") {
                    prop[odd ? "right" : "left"] = pageWidth - prop.width;
                    prop[odd ? "left" : "right"] = "auto";
                  } else {
                    prop[odd ? "left" : "right"] = pageWidth - prop.width;
                    prop[odd ? "right" : "left"] = "auto";
                  }
                }
              }

              return prop;
            },

            // Prepares the flip effect for a page

            _makeFlip: function (page) {
              var data = this.data();

              if (!data.pages[page] && data.pagePlace[page] == page) {
                var single = data.display == "single",
                  odd = page % 2;

                data.pages[page] = data.pageObjs[page]
                  .css(turnMethods._pageSize.call(this, page))
                  .flip({
                    page: page,
                    next: odd || single ? page + 1 : page - 1,
                    turn: this,
                  })
                  .flip("disable", data.disabled);

                // Issue about z-index
                turnMethods._setPageLoc.call(this, page);

                data.pageZoom[page] = data.zoom;
              }

              return data.pages[page];
            },

            // Makes pages within a range

            _makeRange: function () {
              var page,
                range,
                data = this.data();

              if (data.totalPages < 1) return;

              range = this.turn("range");

              for (page = range[0]; page <= range[1]; page++)
                turnMethods._addPage.call(this, page);
            },

            // Returns a range of pages that should be in the DOM
            // Example:
            // - page in the current view, return true
            // * page is in the range, return true
            // Otherwise, return false
            //
            // 1 2-3 4-5 6-7 8-9 10-11 12-13
            //   **  **  --   **  **

            range: function (page) {
              var remainingPages,
                left,
                right,
                view,
                data = this.data();

              page = page || data.tpage || data.page || 1;
              view = turnMethods._view.call(this, page);

              if (page < 1 || page > data.totalPages)
                throw turnError('"' + page + '" is not a valid page');

              view[1] = view[1] || view[0];

              if (view[0] >= 1 && view[1] <= data.totalPages) {
                remainingPages = Math.floor((pagesInDOM - 2) / 2);

                if (data.totalPages - view[1] > view[0]) {
                  left = Math.min(view[0] - 1, remainingPages);
                  right = 2 * remainingPages - left;
                } else {
                  right = Math.min(data.totalPages - view[1], remainingPages);
                  left = 2 * remainingPages - right;
                }
              } else {
                left = pagesInDOM - 1;
                right = pagesInDOM - 1;
              }

              return [
                Math.max(1, view[0] - left),
                Math.min(data.totalPages, view[1] + right),
              ];
            },

            // Detects if a page is within the range of `pagesInDOM` from the current view

            _necessPage: function (page) {
              if (page === 0) return true;

              var range = this.turn("range");

              return (
                this.data().pageObjs[page].hasClass("fixed") ||
                (page >= range[0] && page <= range[1])
              );
            },

            // Releases memory by removing pages from the DOM

            _removeFromDOM: function () {
              var page,
                data = this.data();

              for (page in data.pageWrap)
                if (
                  has(page, data.pageWrap) &&
                  !turnMethods._necessPage.call(this, page)
                )
                  turnMethods._removePageFromDOM.call(this, page);
            },

            // Removes a page from DOM and its internal references

            _removePageFromDOM: function (page) {
              var data = this.data();

              if (data.pages[page]) {
                var dd = data.pages[page].data();

                flipMethods._moveFoldingPage.call(data.pages[page], false);

                if (dd.f && dd.f.fwrapper) dd.f.fwrapper.remove();

                data.pages[page].removeData();
                data.pages[page].remove();
                delete data.pages[page];
              }

              if (data.pageObjs[page]) data.pageObjs[page].remove();

              if (data.pageWrap[page]) {
                data.pageWrap[page].remove();
                delete data.pageWrap[page];
              }

              turnMethods._removeMv.call(this, page);

              delete data.pagePlace[page];
              delete data.pageZoom[page];
            },

            // Removes a page

            removePage: function (page) {
              var data = this.data();

              // Delete all the pages
              if (page == "*") {
                while (data.totalPages !== 0) {
                  this.turn("removePage", data.totalPages);
                }
              } else {
                if (page < 1 || page > data.totalPages)
                  throw turnError("The page " + page + " doesn't exist");

                if (data.pageObjs[page]) {
                  // Stop animations
                  this.turn("stop");

                  // Remove `page`
                  turnMethods._removePageFromDOM.call(this, page);

                  delete data.pageObjs[page];
                }

                // Move the pages
                turnMethods._movePages.call(this, page, -1);

                // Resize the size of this flipbook
                data.totalPages = data.totalPages - 1;

                // Check the current view

                if (data.page > data.totalPages) {
                  data.page = null;
                  turnMethods._fitPage.call(this, data.totalPages);
                } else {
                  turnMethods._makeRange.call(this);
                  this.turn("update");
                }
              }

              return this;
            },

            // Moves pages

            _movePages: function (from, change) {
              var page,
                that = this,
                data = this.data(),
                single = data.display == "single",
                move = function (page) {
                  var next = page + change,
                    odd = next % 2,
                    className = odd ? " odd " : " even ";

                  if (data.pageObjs[page])
                    data.pageObjs[next] = data.pageObjs[page]
                      .removeClass("p" + page + " odd even")
                      .addClass("p" + next + className);

                  if (data.pagePlace[page] && data.pageWrap[page]) {
                    data.pagePlace[next] = next;

                    if (data.pageObjs[next].hasClass("fixed"))
                      data.pageWrap[next] = data.pageWrap[page].attr(
                        "page",
                        next
                      );
                    else
                      data.pageWrap[next] = data.pageWrap[page]
                        .css(turnMethods._pageSize.call(that, next, true))
                        .attr("page", next);

                    if (data.pages[page])
                      data.pages[next] = data.pages[page].flip("options", {
                        page: next,
                        next: single || odd ? next + 1 : next - 1,
                      });

                    if (change) {
                      delete data.pages[page];
                      delete data.pagePlace[page];
                      delete data.pageZoom[page];
                      delete data.pageObjs[page];
                      delete data.pageWrap[page];
                    }
                  }
                };

              if (change > 0)
                for (page = data.totalPages; page >= from; page--) move(page);
              else
                for (page = from; page <= data.totalPages; page++) move(page);
            },

            // Sets or Gets the display mode

            display: function (display) {
              var data = this.data(),
                currentDisplay = data.display;

              if (display === undefined) {
                return currentDisplay;
              } else {
                if ($.inArray(display, displays) == -1)
                  throw turnError(
                    '"' + display + '" is not a value for display'
                  );

                switch (display) {
                  case "single":
                    // Create a temporal page to use as folded page

                    if (!data.pageObjs[0]) {
                      this.turn("stop").css({ overflow: "hidden" });

                      data.pageObjs[0] = $("<div />", {
                        class: "page p-temporal",
                      })
                        .css({ width: this.width(), height: this.height() })
                        .appendTo(this);
                    }

                    this.addClass("shadow");

                    break;
                  case "double":
                    // Remove the temporal page

                    if (data.pageObjs[0]) {
                      this.turn("stop").css({ overflow: "" });
                      data.pageObjs[0].remove();
                      delete data.pageObjs[0];
                    }

                    this.removeClass("shadow");

                    break;
                }

                data.display = display;

                if (currentDisplay) {
                  var size = this.turn("size");
                  turnMethods._movePages.call(this, 1, 0);
                  this.turn("size", size.width, size.height).turn("update");
                }

                return this;
              }
            },

            // Gets and sets the direction of the flipbook

            direction: function (dir) {
              var data = this.data();

              if (dir === undefined) {
                return data.direction;
              } else {
                dir = dir.toLowerCase();

                if ($.inArray(dir, directions) == -1)
                  throw turnError('"' + dir + '" is not a value for direction');

                if (dir == "rtl") {
                  $(this).attr("dir", "ltr").css({ direction: "ltr" });
                }

                data.direction = dir;

                if (data.done)
                  this.turn("size", $(this).width(), $(this).height());

                return this;
              }
            },

            // Detects animation

            animating: function () {
              return this.data().pageMv.length > 0;
            },

            // Gets the current activated corner

            corner: function () {
              var corner,
                page,
                data = this.data();

              for (page in data.pages) {
                if (has(page, data.pages))
                  if ((corner = data.pages[page].flip("corner"))) {
                    return corner;
                  }
              }

              return false;
            },

            // Gets the data stored in the flipbook

            data: function () {
              return this.data();
            },

            // Disables and enables the effect

            disable: function (disable) {
              var page,
                data = this.data(),
                view = this.turn("view");

              data.disabled = disable === undefined || disable === true;

              for (page in data.pages) {
                if (has(page, data.pages))
                  data.pages[page].flip(
                    "disable",
                    data.disabled
                      ? true
                      : $.inArray(parseInt(page, 10), view) == -1
                  );
              }

              return this;
            },

            // Disables and enables the effect

            disabled: function (disable) {
              if (disable === undefined) {
                return this.data().disabled === true;
              } else {
                return this.turn("disable", disable);
              }
            },

            // Gets and sets the size

            size: function (width, height) {
              if (width === undefined || height === undefined) {
                return { width: this.width(), height: this.height() };
              } else {
                this.turn("stop");

                var page,
                  prop,
                  data = this.data(),
                  pageWidth = data.display == "double" ? width / 2 : width;

                this.css({ width: width, height: height });

                if (data.pageObjs[0])
                  data.pageObjs[0].css({ width: pageWidth, height: height });

                for (page in data.pageWrap) {
                  if (!has(page, data.pageWrap)) continue;

                  prop = turnMethods._pageSize.call(this, page, true);

                  data.pageObjs[page].css({
                    width: prop.width,
                    height: prop.height,
                  });
                  data.pageWrap[page].css(prop);

                  if (data.pages[page])
                    data.pages[page].css({
                      width: prop.width,
                      height: prop.height,
                    });
                }

                this.turn("resize");

                return this;
              }
            },

            // Resizes each page

            resize: function () {
              var page,
                data = this.data();

              if (data.pages[0]) {
                data.pageWrap[0].css({ left: -this.width() });
                data.pages[0].flip("resize", true);
              }

              for (page = 1; page <= data.totalPages; page++)
                if (data.pages[page]) data.pages[page].flip("resize", true);

              turnMethods._updateShadow.call(this);

              if (data.opts.autoCenter) this.turn("center");
            },

            // Removes an animation from the cache

            _removeMv: function (page) {
              var i,
                data = this.data();

              for (i = 0; i < data.pageMv.length; i++)
                if (data.pageMv[i] == page) {
                  data.pageMv.splice(i, 1);
                  return true;
                }

              return false;
            },

            // Adds an animation to the cache

            _addMv: function (page) {
              var data = this.data();

              turnMethods._removeMv.call(this, page);
              data.pageMv.push(page);
            },

            // Gets indexes for a view

            _view: function (page) {
              var data = this.data();

              page = page || data.page;

              if (data.display == "double")
                return page % 2 ? [page - 1, page] : [page, page + 1];
              else return [page];
            },

            // Gets a view

            view: function (page) {
              var data = this.data(),
                view = turnMethods._view.call(this, page);

              if (data.display == "double")
                return [
                  view[0] > 0 ? view[0] : 0,
                  view[1] <= data.totalPages ? view[1] : 0,
                ];
              else
                return [
                  view[0] > 0 && view[0] <= data.totalPages ? view[0] : 0,
                ];
            },

            // Stops animations

            stop: function (ignore, animate) {
              if (this.turn("animating")) {
                var i,
                  opts,
                  page,
                  data = this.data();

                if (data.tpage) {
                  data.page = data.tpage;
                  delete data["tpage"];
                }

                for (i = 0; i < data.pageMv.length; i++) {
                  if (!data.pageMv[i] || data.pageMv[i] === ignore) continue;

                  page = data.pages[data.pageMv[i]];
                  opts = page.data().f.opts;

                  page.flip("hideFoldedPage", animate);

                  if (!animate) flipMethods._moveFoldingPage.call(page, false);

                  if (opts.force) {
                    opts.next =
                      opts.page % 2 === 0 ? opts.page - 1 : opts.page + 1;
                    delete opts["force"];
                  }
                }
              }

              this.turn("update");

              return this;
            },

            // Gets and sets the number of pages

            pages: function (pages) {
              var data = this.data();

              if (pages) {
                if (pages < data.totalPages) {
                  for (var page = data.totalPages; page > pages; page--)
                    this.turn("removePage", page);
                }

                data.totalPages = pages;
                turnMethods._fitPage.call(this, data.page);

                return this;
              } else return data.totalPages;
            },

            // Checks missing pages

            _missing: function (page) {
              var data = this.data();

              if (data.totalPages < 1) return;

              var p,
                range = this.turn("range", page),
                missing = [];

              for (p = range[0]; p <= range[1]; p++) {
                if (!data.pageObjs[p]) missing.push(p);
              }

              if (missing.length > 0) this.trigger("missing", [missing]);
            },

            // Sets a page without effect

            _fitPage: function (page) {
              var data = this.data(),
                newView = this.turn("view", page);

              turnMethods._missing.call(this, page);

              if (!data.pageObjs[page]) return;

              data.page = page;

              this.turn("stop");

              for (var i = 0; i < newView.length; i++) {
                if (newView[i] && data.pageZoom[newView[i]] != data.zoom) {
                  this.trigger("zoomed", [
                    newView[i],
                    newView,
                    data.pageZoom[newView[i]],
                    data.zoom,
                  ]);

                  data.pageZoom[newView[i]] = data.zoom;
                }
              }

              turnMethods._removeFromDOM.call(this);
              turnMethods._makeRange.call(this);
              turnMethods._updateShadow.call(this);
              this.trigger("turned", [page, newView]);
              this.turn("update");

              if (data.opts.autoCenter) this.turn("center");
            },

            // Turns the page

            _turnPage: function (page) {
              var current,
                next,
                data = this.data(),
                place = data.pagePlace[page],
                view = this.turn("view"),
                newView = this.turn("view", page);

              if (data.page != page) {
                var currentPage = data.page;

                if (trigger("turning", this, [page, newView]) == "prevented") {
                  if (
                    currentPage == data.page &&
                    $.inArray(place, data.pageMv) != -1
                  )
                    data.pages[place].flip("hideFoldedPage", true);

                  return;
                }

                if ($.inArray(1, newView) != -1) this.trigger("first");
                if ($.inArray(data.totalPages, newView) != -1)
                  this.trigger("last");
              }

              if (data.display == "single") {
                current = view[0];
                next = newView[0];
              } else if (view[1] && page > view[1]) {
                current = view[1];
                next = newView[0];
              } else if (view[0] && page < view[0]) {
                current = view[0];
                next = newView[1];
              }

              var optsCorners = data.opts.turnCorners.split(","),
                flipData = data.pages[current].data().f,
                opts = flipData.opts,
                actualPoint = flipData.point;

              turnMethods._missing.call(this, page);

              if (!data.pageObjs[page]) return;

              this.turn("stop");

              data.page = page;

              turnMethods._makeRange.call(this);

              data.tpage = next;

              if (opts.next != next) {
                opts.next = next;
                opts.force = true;
              }

              this.turn("update");

              flipData.point = actualPoint;

              if (flipData.effect == "hard") {
                if (data.direction == "ltr")
                  data.pages[current].flip(
                    "turnPage",
                    page > current ? "r" : "l"
                  );
                else
                  data.pages[current].flip(
                    "turnPage",
                    page > current ? "l" : "r"
                  );
              } else {
                if (data.direction == "ltr")
                  data.pages[current].flip(
                    "turnPage",
                    optsCorners[page > current ? 1 : 0]
                  );
                else
                  data.pages[current].flip(
                    "turnPage",
                    optsCorners[page > current ? 0 : 1]
                  );
              }
            },

            // Gets and sets a page

            page: function (page) {
              var data = this.data();

              if (page === undefined) {
                return data.page;
              } else {
                if (!data.disabled && !data.destroying) {
                  page = parseInt(page, 10);

                  if (page > 0 && page <= data.totalPages) {
                    if (page != data.page) {
                      if (
                        !data.done ||
                        $.inArray(page, this.turn("view")) != -1
                      )
                        turnMethods._fitPage.call(this, page);
                      else turnMethods._turnPage.call(this, page);
                    }

                    return this;
                  } else {
                    throw turnError("The page " + page + " does not exist");
                  }
                }
              }
            },

            // Turns to the next view

            next: function () {
              return this.turn(
                "page",
                Math.min(
                  this.data().totalPages,
                  turnMethods._view.call(this, this.data().page).pop() + 1
                )
              );
            },

            // Turns to the previous view

            previous: function () {
              return this.turn(
                "page",
                Math.max(
                  1,
                  turnMethods._view.call(this, this.data().page).shift() - 1
                )
              );
            },

            // Shows a peeling corner

            peel: function (corner, animate) {
              var data = this.data(),
                view = this.turn("view");

              animate = animate === undefined ? true : animate === true;

              if (corner === false) {
                this.turn("stop", null, animate);
              } else {
                if (data.display == "single") {
                  data.pages[data.page].flip("peel", corner, animate);
                } else {
                  var page;

                  if (data.direction == "ltr") {
                    page = corner.indexOf("l") != -1 ? view[0] : view[1];
                  } else {
                    page = corner.indexOf("l") != -1 ? view[1] : view[0];
                  }

                  if (data.pages[page])
                    data.pages[page].flip("peel", corner, animate);
                }
              }

              return this;
            },

            // Adds a motion to the internal list
            // This event is called in context of flip

            _addMotionPage: function () {
              var opts = $(this).data().f.opts,
                turn = opts.turn,
                dd = turn.data();

              turnMethods._addMv.call(turn, opts.page);
            },

            // This event is called in context of flip

            _eventStart: function (e, opts, corner) {
              var data = opts.turn.data(),
                actualZoom = data.pageZoom[opts.page];

              if (e.isDefaultPrevented()) {
                turnMethods._updateShadow.call(opts.turn);
                return;
              }

              if (actualZoom && actualZoom != data.zoom) {
                opts.turn.trigger("zoomed", [
                  opts.page,
                  opts.turn.turn("view", opts.page),
                  actualZoom,
                  data.zoom,
                ]);

                data.pageZoom[opts.page] = data.zoom;
              }

              if (data.display == "single" && corner) {
                if (
                  (corner.charAt(1) == "l" && data.direction == "ltr") ||
                  (corner.charAt(1) == "r" && data.direction == "rtl")
                ) {
                  opts.next = opts.next < opts.page ? opts.next : opts.page - 1;
                  opts.force = true;
                } else {
                  opts.next = opts.next > opts.page ? opts.next : opts.page + 1;
                }
              }

              turnMethods._addMotionPage.call(e.target);
              turnMethods._updateShadow.call(opts.turn);
            },

            // This event is called in context of flip

            _eventEnd: function (e, opts, turned) {
              var that = $(e.target),
                data = that.data().f,
                turn = opts.turn,
                dd = turn.data();

              if (turned) {
                var tpage = dd.tpage || dd.page;

                if (tpage == opts.next || tpage == opts.page) {
                  delete dd.tpage;

                  turnMethods._fitPage.call(turn, tpage || opts.next, true);
                }
              } else {
                turnMethods._removeMv.call(turn, opts.page);
                turnMethods._updateShadow.call(turn);
                turn.turn("update");
              }
            },

            // This event is called in context of flip

            _eventPressed: function (e) {
              var page,
                data = $(e.target).data().f,
                turn = data.opts.turn,
                turnData = turn.data(),
                pages = turnData.pages;

              turnData.mouseAction = true;

              turn.turn("update");

              return (data.time = new Date().getTime());
            },

            // This event is called in context of flip

            _eventReleased: function (e, point) {
              var outArea,
                page = $(e.target),
                data = page.data().f,
                turn = data.opts.turn,
                turnData = turn.data();

              if (turnData.display == "single") {
                outArea =
                  point.corner == "br" || point.corner == "tr"
                    ? point.x < page.width() / 2
                    : point.x > page.width() / 2;
              } else {
                outArea = point.x < 0 || point.x > page.width();
              }

              if (new Date().getTime() - data.time < 200 || outArea) {
                e.preventDefault();
                turnMethods._turnPage.call(turn, data.opts.next);
              }

              turnData.mouseAction = false;
            },

            // This event is called in context of flip

            _flip: function (e) {
              e.stopPropagation();

              var opts = $(e.target).data().f.opts;

              opts.turn.trigger("turn", [opts.next]);

              if (opts.turn.data().opts.autoCenter) {
                opts.turn.turn("center", opts.next);
              }
            },

            //
            _touchStart: function () {
              var data = this.data();
              for (var page in data.pages) {
                if (
                  has(page, data.pages) &&
                  flipMethods._eventStart.apply(data.pages[page], arguments) ===
                    false
                ) {
                  return false;
                }
              }
            },

            //
            _touchMove: function () {
              var data = this.data();
              for (var page in data.pages) {
                if (has(page, data.pages)) {
                  flipMethods._eventMove.apply(data.pages[page], arguments);
                }
              }
            },

            //
            _touchEnd: function () {
              var data = this.data();
              for (var page in data.pages) {
                if (has(page, data.pages)) {
                  flipMethods._eventEnd.apply(data.pages[page], arguments);
                }
              }
            },

            // Calculate the z-index value for pages during the animation

            calculateZ: function (mv) {
              var i,
                page,
                nextPage,
                placePage,
                dpage,
                that = this,
                data = this.data(),
                view = this.turn("view"),
                currentPage = view[0] || view[1],
                total = mv.length - 1,
                r = { pageZ: {}, partZ: {}, pageV: {} },
                addView = function (page) {
                  var view = that.turn("view", page);
                  if (view[0]) r.pageV[view[0]] = true;
                  if (view[1]) r.pageV[view[1]] = true;
                };

              for (i = 0; i <= total; i++) {
                page = mv[i];
                nextPage = data.pages[page].data().f.opts.next;
                placePage = data.pagePlace[page];
                addView(page);
                addView(nextPage);
                dpage = data.pagePlace[nextPage] == nextPage ? nextPage : page;
                r.pageZ[dpage] =
                  data.totalPages - Math.abs(currentPage - dpage);
                r.partZ[placePage] = data.totalPages * 2 - total + i;
              }

              return r;
            },

            // Updates the z-index and display property of every page

            update: function () {
              var page,
                data = this.data();

              if (this.turn("animating") && data.pageMv[0] !== 0) {
                // Update motion

                var p,
                  apage,
                  fixed,
                  pos = this.turn("calculateZ", data.pageMv),
                  corner = this.turn("corner"),
                  actualView = this.turn("view"),
                  newView = this.turn("view", data.tpage);

                for (page in data.pageWrap) {
                  if (!has(page, data.pageWrap)) continue;

                  fixed = data.pageObjs[page].hasClass("fixed");

                  data.pageWrap[page].css({
                    display: pos.pageV[page] || fixed ? "" : "none",
                    zIndex:
                      (data.pageObjs[page].hasClass("hard")
                        ? pos.partZ[page]
                        : pos.pageZ[page]) || (fixed ? -1 : 0),
                  });

                  if ((p = data.pages[page])) {
                    p.flip("z", pos.partZ[page] || null);

                    if (pos.pageV[page]) p.flip("resize");

                    if (data.tpage) {
                      // Is it turning the page to `tpage`?

                      p.flip("hover", false).flip(
                        "disable",
                        $.inArray(parseInt(page, 10), data.pageMv) == -1 &&
                          page != newView[0] &&
                          page != newView[1]
                      );
                    } else {
                      p.flip("hover", corner === false).flip(
                        "disable",
                        page != actualView[0] && page != actualView[1]
                      );
                    }
                  }
                }
              } else {
                // Update static pages

                for (page in data.pageWrap) {
                  if (!has(page, data.pageWrap)) continue;

                  var pageLocation = turnMethods._setPageLoc.call(this, page);

                  if (data.pages[page]) {
                    data.pages[page]
                      .flip("disable", data.disabled || pageLocation != 1)
                      .flip("hover", true)
                      .flip("z", null);
                  }
                }
              }

              return this;
            },

            // Updates the position and size of the flipbook's shadow

            _updateShadow: function () {
              var view,
                view2,
                shadow,
                data = this.data(),
                width = this.width(),
                height = this.height(),
                pageWidth = data.display == "single" ? width : width / 2;

              view = this.turn("view");

              if (!data.shadow) {
                data.shadow = $("<div />", {
                  class: "shadow",
                  css: divAtt(0, 0, 0).css,
                }).appendTo(this);
              }

              for (var i = 0; i < data.pageMv.length; i++) {
                if (!view[0] || !view[1]) break;

                view = this.turn(
                  "view",
                  data.pages[data.pageMv[i]].data().f.opts.next
                );
                view2 = this.turn("view", data.pageMv[i]);

                view[0] = view[0] && view2[0];
                view[1] = view[1] && view2[1];
              }

              if (!view[0]) shadow = data.direction == "ltr" ? 1 : 2;
              else if (!view[1]) shadow = data.direction == "ltr" ? 2 : 1;
              else shadow = 3;

              switch (shadow) {
                case 1:
                  data.shadow.css({
                    width: pageWidth,
                    height: height,
                    top: 0,
                    left: pageWidth,
                  });

                  break;
                case 2:
                  data.shadow.css({
                    width: pageWidth,
                    height: height,
                    top: 0,
                    left: 0,
                  });

                  break;
                case 3:
                  data.shadow.css({
                    width: width,
                    height: height,
                    top: 0,
                    left: 0,
                  });

                  break;
              }
            },

            // Sets the z-index and display property of a page
            // It depends on the current view

            _setPageLoc: function (page) {
              var data = this.data(),
                view = this.turn("view"),
                loc = 0;

              if (page == view[0] || page == view[1]) loc = 1;
              else if (
                (data.display == "single" && page == view[0] + 1) ||
                (data.display == "double" && page == view[0] - 2) ||
                page == view[1] + 2
              )
                loc = 2;

              if (!this.turn("animating"))
                switch (loc) {
                  case 1:
                    data.pageWrap[page].css({
                      zIndex: data.totalPages,
                      display: "",
                    });

                    break;
                  case 2:
                    data.pageWrap[page].css({
                      zIndex: data.totalPages - 1,
                      display: "",
                    });

                    break;
                  case 0:
                    data.pageWrap[page].css({
                      zIndex: 0,
                      display: data.pageObjs[page].hasClass("fixed")
                        ? ""
                        : "none",
                    });

                    break;
                }

              return loc;
            },

            // Gets and sets the options

            options: function (options) {
              if (options === undefined) {
                return this.data().opts;
              } else {
                var data = this.data();

                // Set new values

                $.extend(data.opts, options);

                // Set pages

                if (options.pages) this.turn("pages", options.pages);

                // Set page

                if (options.page) this.turn("page", options.page);

                // Set display

                if (options.display) this.turn("display", options.display);

                // Set direction

                if (options.direction)
                  this.turn("direction", options.direction);

                // Set size

                if (options.width && options.height)
                  this.turn("size", options.width, options.height);

                // Add event listeners

                if (options.when)
                  for (var eventName in options.when)
                    if (has(eventName, options.when)) {
                      this.unbind(eventName).bind(
                        eventName,
                        options.when[eventName]
                      );
                    }

                return this;
              }
            },

            // Gets the current version

            version: function () {
              return version;
            },
          },
          // Methods and properties for the flip page effect

          flipMethods = {
            // Constructor

            init: function (opts) {
              this.data({
                f: {
                  disabled: false,
                  hover: false,
                  effect: this.hasClass("hard") ? "hard" : "sheet",
                },
              });

              this.flip("options", opts);

              flipMethods._addPageWrapper.call(this);

              return this;
            },

            setData: function (d) {
              var data = this.data();

              data.f = $.extend(data.f, d);

              return this;
            },

            options: function (opts) {
              var data = this.data().f;

              if (opts) {
                flipMethods.setData.call(this, {
                  opts: $.extend({}, data.opts || flipOptions, opts),
                });
                return this;
              } else return data.opts;
            },

            z: function (z) {
              var data = this.data().f;

              data.opts["z-index"] = z;

              if (data.fwrapper)
                data.fwrapper.css({
                  zIndex: z || parseInt(data.parent.css("z-index"), 10) || 0,
                });

              return this;
            },

            _cAllowed: function () {
              var data = this.data().f,
                page = data.opts.page,
                turnData = data.opts.turn.data(),
                odd = page % 2;

              if (data.effect == "hard") {
                return turnData.direction == "ltr"
                  ? [odd ? "r" : "l"]
                  : [odd ? "l" : "r"];
              } else {
                if (turnData.display == "single") {
                  if (page == 1)
                    return turnData.direction == "ltr"
                      ? corners["forward"]
                      : corners["backward"];
                  else if (page == turnData.totalPages)
                    return turnData.direction == "ltr"
                      ? corners["backward"]
                      : corners["forward"];
                  else return corners["all"];
                } else {
                  return turnData.direction == "ltr"
                    ? corners[odd ? "forward" : "backward"]
                    : corners[odd ? "backward" : "forward"];
                }
              }
            },

            _cornerActivated: function (p) {
              var data = this.data().f,
                width = this.width(),
                height = this.height(),
                point = { x: p.x, y: p.y, corner: "" },
                csz = data.opts.cornerSize;

              if (
                point.x <= 0 ||
                point.y <= 0 ||
                point.x >= width ||
                point.y >= height
              )
                return false;

              var allowedCorners = flipMethods._cAllowed.call(this);

              switch (data.effect) {
                case "hard":
                  if (point.x > width - csz) point.corner = "r";
                  else if (point.x < csz) point.corner = "l";
                  else return false;

                  break;

                case "sheet":
                  if (point.y < csz) point.corner += "t";
                  else if (point.y >= height - csz) point.corner += "b";
                  else return false;

                  if (point.x <= csz) point.corner += "l";
                  else if (point.x >= width - csz) point.corner += "r";
                  else return false;

                  break;
              }

              return !point.corner ||
                $.inArray(point.corner, allowedCorners) == -1
                ? false
                : point;
            },

            _isIArea: function (e) {
              var pos = this.data().f.parent.offset();

              e = isTouch && e.originalEvent ? e.originalEvent.touches[0] : e;

              return flipMethods._cornerActivated.call(this, {
                x: e.pageX - pos.left,
                y: e.pageY - pos.top,
              });
            },

            _c: function (corner, opts) {
              opts = opts || 0;

              switch (corner) {
                case "tl":
                  return point2D(opts, opts);
                case "tr":
                  return point2D(this.width() - opts, opts);
                case "bl":
                  return point2D(opts, this.height() - opts);
                case "br":
                  return point2D(this.width() - opts, this.height() - opts);
                case "l":
                  return point2D(opts, 0);
                case "r":
                  return point2D(this.width() - opts, 0);
              }
            },

            _c2: function (corner) {
              switch (corner) {
                case "tl":
                  return point2D(this.width() * 2, 0);
                case "tr":
                  return point2D(-this.width(), 0);
                case "bl":
                  return point2D(this.width() * 2, this.height());
                case "br":
                  return point2D(-this.width(), this.height());
                case "l":
                  return point2D(this.width() * 2, 0);
                case "r":
                  return point2D(-this.width(), 0);
              }
            },

            _foldingPage: function () {
              var data = this.data().f;

              if (!data) return;

              var opts = data.opts;

              if (opts.turn) {
                data = opts.turn.data();
                if (data.display == "single")
                  return opts.next > 1 || opts.page > 1
                    ? data.pageObjs[0]
                    : null;
                else return data.pageObjs[opts.next];
              }
            },

            _backGradient: function () {
              var data = this.data().f,
                turnData = data.opts.turn.data(),
                gradient =
                  turnData.opts.gradients &&
                  (turnData.display == "single" ||
                    (data.opts.page != 2 &&
                      data.opts.page != turnData.totalPages - 1));

              if (gradient && !data.bshadow)
                data.bshadow = $("<div/>", divAtt(0, 0, 1))
                  .css({
                    position: "",
                    width: this.width(),
                    height: this.height(),
                  })
                  .appendTo(data.parent);

              return gradient;
            },

            type: function () {
              return this.data().f.effect;
            },

            resize: function (full) {
              var data = this.data().f,
                turnData = data.opts.turn.data(),
                width = this.width(),
                height = this.height();

              switch (data.effect) {
                case "hard":
                  if (full) {
                    data.wrapper.css({ width: width, height: height });
                    data.fpage.css({ width: width, height: height });
                    if (turnData.opts.gradients) {
                      data.ashadow.css({ width: width, height: height });
                      data.bshadow.css({ width: width, height: height });
                    }
                  }

                  break;
                case "sheet":
                  if (full) {
                    var size = Math.round(
                      Math.sqrt(Math.pow(width, 2) + Math.pow(height, 2))
                    );

                    data.wrapper.css({ width: size, height: size });
                    data.fwrapper
                      .css({ width: size, height: size })
                      .children(":first-child")
                      .css({ width: width, height: height });

                    data.fpage.css({ width: width, height: height });

                    if (turnData.opts.gradients)
                      data.ashadow.css({ width: width, height: height });

                    if (flipMethods._backGradient.call(this))
                      data.bshadow.css({ width: width, height: height });
                  }

                  if (data.parent.is(":visible")) {
                    var offset = findPos(data.parent[0]);

                    data.fwrapper.css({ top: offset.top, left: offset.left });

                    //if (data.opts.turn) {
                    offset = findPos(data.opts.turn[0]);
                    data.fparent.css({ top: -offset.top, left: -offset.left });
                    //}
                  }

                  this.flip("z", data.opts["z-index"]);

                  break;
              }
            },

            // Prepares the page by adding a general wrapper and another objects

            _addPageWrapper: function () {
              var att,
                data = this.data().f,
                turnData = data.opts.turn.data(),
                parent = this.parent();

              data.parent = parent;

              if (!data.wrapper)
                switch (data.effect) {
                  case "hard":
                    var cssProperties = {};
                    cssProperties[vendor + "transform-style"] = "preserve-3d";
                    cssProperties[vendor + "backface-visibility"] = "hidden";

                    data.wrapper = $("<div/>", divAtt(0, 0, 2))
                      .css(cssProperties)
                      .appendTo(parent)
                      .prepend(this);

                    data.fpage = $("<div/>", divAtt(0, 0, 1))
                      .css(cssProperties)
                      .appendTo(parent);

                    if (turnData.opts.gradients) {
                      data.ashadow = $("<div/>", divAtt(0, 0, 0))
                        .hide()
                        .appendTo(parent);

                      data.bshadow = $("<div/>", divAtt(0, 0, 0));
                    }

                    break;
                  case "sheet":
                    var width = this.width(),
                      height = this.height(),
                      size = Math.round(
                        Math.sqrt(Math.pow(width, 2) + Math.pow(height, 2))
                      );

                    data.fparent = data.opts.turn.data().fparent;

                    if (!data.fparent) {
                      var fparent = $("<div/>", {
                        css: { "pointer-events": "none" },
                      }).hide();
                      fparent.data().flips = 0;
                      fparent
                        .css(divAtt(0, 0, "auto", "visible").css)
                        .appendTo(data.opts.turn);

                      data.opts.turn.data().fparent = fparent;
                      data.fparent = fparent;
                    }

                    this.css({
                      position: "absolute",
                      top: 0,
                      left: 0,
                      bottom: "auto",
                      right: "auto",
                    });

                    data.wrapper = $(
                      "<div/>",
                      divAtt(0, 0, this.css("z-index"))
                    )
                      .appendTo(parent)
                      .prepend(this);

                    data.fwrapper = $(
                      "<div/>",
                      divAtt(parent.offset().top, parent.offset().left)
                    )
                      .hide()
                      .appendTo(data.fparent);

                    data.fpage = $("<div/>", divAtt(0, 0, 0, "visible"))
                      .css({ cursor: "default" })
                      .appendTo(data.fwrapper);

                    if (turnData.opts.gradients)
                      data.ashadow = $("<div/>", divAtt(0, 0, 1)).appendTo(
                        data.fpage
                      );

                    flipMethods.setData.call(this, data);

                    break;
                }

              // Set size
              flipMethods.resize.call(this, true);
            },

            // Takes a 2P point from the screen and applies the transformation

            _fold: function (point) {
              var data = this.data().f,
                turnData = data.opts.turn.data(),
                o = flipMethods._c.call(this, point.corner),
                width = this.width(),
                height = this.height();

              switch (data.effect) {
                case "hard":
                  if (point.corner == "l")
                    point.x = Math.min(Math.max(point.x, 0), width * 2);
                  else point.x = Math.max(Math.min(point.x, width), -width);

                  var leftPos,
                    shadow,
                    gradientX,
                    fpageOrigin,
                    parentOrigin,
                    totalPages = turnData.totalPages,
                    zIndex = data.opts["z-index"] || totalPages,
                    parentCss = { overflow: "visible" },
                    relX = o.x ? (o.x - point.x) / width : point.x / width,
                    angle = relX * 90,
                    half = angle < 90;

                  switch (point.corner) {
                    case "l":
                      fpageOrigin = "0% 50%";
                      parentOrigin = "100% 50%";

                      if (half) {
                        leftPos = 0;
                        shadow = data.opts.next - 1 > 0;
                        gradientX = 1;
                      } else {
                        leftPos = "100%";
                        shadow = data.opts.page + 1 < totalPages;
                        gradientX = 0;
                      }

                      break;
                    case "r":
                      fpageOrigin = "100% 50%";
                      parentOrigin = "0% 50%";
                      angle = -angle;
                      width = -width;

                      if (half) {
                        leftPos = 0;
                        shadow = data.opts.next + 1 < totalPages;
                        gradientX = 0;
                      } else {
                        leftPos = "-100%";
                        shadow = data.opts.page != 1;
                        gradientX = 1;
                      }

                      break;
                  }

                  parentCss[vendor + "perspective-origin"] = parentOrigin;

                  data.wrapper.transform(
                    "rotateY(" +
                      angle +
                      "deg)" +
                      "translate3d(0px, 0px, " +
                      (this.attr("depth") || 0) +
                      "px)",
                    parentOrigin
                  );

                  data.fpage.transform(
                    "translateX(" +
                      width +
                      "px) rotateY(" +
                      (180 + angle) +
                      "deg)",
                    fpageOrigin
                  );

                  data.parent.css(parentCss);

                  if (half) {
                    relX = -relX + 1;
                    data.wrapper.css({ zIndex: zIndex + 1 });
                    data.fpage.css({ zIndex: zIndex });
                  } else {
                    relX = relX - 1;
                    data.wrapper.css({ zIndex: zIndex });
                    data.fpage.css({ zIndex: zIndex + 1 });
                  }

                  if (turnData.opts.gradients) {
                    if (shadow)
                      data.ashadow
                        .css({
                          display: "",
                          left: leftPos,
                          backgroundColor: "rgba(0,0,0," + 0.5 * relX + ")",
                        })
                        .transform("rotateY(0deg)");
                    else data.ashadow.hide();

                    data.bshadow.css({ opacity: -relX + 1 });

                    if (half) {
                      if (data.bshadow.parent()[0] != data.wrapper[0]) {
                        data.bshadow.appendTo(data.wrapper);
                      }
                    } else {
                      if (data.bshadow.parent()[0] != data.fpage[0]) {
                        data.bshadow.appendTo(data.fpage);
                      }
                    }
                    /*data.bshadow.css({
              backgroundColor: 'rgba(0,0,0,'+(0.1)+')'
            })*/
                    gradient(
                      data.bshadow,
                      point2D(gradientX * 100, 0),
                      point2D((-gradientX + 1) * 100, 0),
                      [
                        [0, "rgba(0,0,0,0.3)"],
                        [1, "rgba(0,0,0,0)"],
                      ],
                      2
                    );
                  }

                  break;
                case "sheet":
                  var that = this,
                    a = 0,
                    alpha = 0,
                    beta,
                    px,
                    gradientEndPointA,
                    gradientEndPointB,
                    gradientStartVal,
                    gradientSize,
                    gradientOpacity,
                    shadowVal,
                    mv = point2D(0, 0),
                    df = point2D(0, 0),
                    tr = point2D(0, 0),
                    folding = flipMethods._foldingPage.call(this),
                    tan = Math.tan(alpha),
                    ac = turnData.opts.acceleration,
                    h = data.wrapper.height(),
                    top = point.corner.substr(0, 1) == "t",
                    left = point.corner.substr(1, 1) == "l",
                    compute = function () {
                      var rel = point2D(0, 0);
                      var middle = point2D(0, 0);

                      rel.x = o.x ? o.x - point.x : point.x;

                      if (!hasRot) {
                        rel.y = 0;
                      } else {
                        rel.y = o.y ? o.y - point.y : point.y;
                      }

                      middle.x = left ? width - rel.x / 2 : point.x + rel.x / 2;
                      middle.y = rel.y / 2;

                      var alpha = A90 - Math.atan2(rel.y, rel.x),
                        gamma = alpha - Math.atan2(middle.y, middle.x),
                        distance = Math.max(
                          0,
                          Math.sin(gamma) *
                            Math.sqrt(
                              Math.pow(middle.x, 2) + Math.pow(middle.y, 2)
                            )
                        );

                      a = deg(alpha);

                      tr = point2D(
                        distance * Math.sin(alpha),
                        distance * Math.cos(alpha)
                      );

                      if (alpha > A90) {
                        tr.x = tr.x + Math.abs((tr.y * rel.y) / rel.x);
                        tr.y = 0;
                        if (Math.round(tr.x * Math.tan(PI - alpha)) < height) {
                          point.y = Math.sqrt(
                            Math.pow(height, 2) + 2 * middle.x * rel.x
                          );
                          if (top) point.y = height - point.y;
                          return compute();
                        }
                      }

                      if (alpha > A90) {
                        var beta = PI - alpha,
                          dd = h - height / Math.sin(beta);
                        mv = point2D(
                          Math.round(dd * Math.cos(beta)),
                          Math.round(dd * Math.sin(beta))
                        );
                        if (left) mv.x = -mv.x;
                        if (top) mv.y = -mv.y;
                      }

                      px = Math.round(tr.y / Math.tan(alpha) + tr.x);

                      var side = width - px,
                        sideX = side * Math.cos(alpha * 2),
                        sideY = side * Math.sin(alpha * 2);
                      df = point2D(
                        Math.round(left ? side - sideX : px + sideX),
                        Math.round(top ? sideY : height - sideY)
                      );

                      // Gradients
                      if (turnData.opts.gradients) {
                        gradientSize = side * Math.sin(alpha);

                        var endingPoint = flipMethods._c2.call(
                            that,
                            point.corner
                          ),
                          far =
                            Math.sqrt(
                              Math.pow(endingPoint.x - point.x, 2) +
                                Math.pow(endingPoint.y - point.y, 2)
                            ) / width;

                        shadowVal = Math.sin(A90 * (far > 1 ? 2 - far : far));

                        gradientOpacity = Math.min(far, 1);

                        gradientStartVal =
                          gradientSize > 100
                            ? (gradientSize - 100) / gradientSize
                            : 0;

                        gradientEndPointA = point2D(
                          ((gradientSize * Math.sin(alpha)) / width) * 100,
                          ((gradientSize * Math.cos(alpha)) / height) * 100
                        );

                        if (flipMethods._backGradient.call(that)) {
                          gradientEndPointB = point2D(
                            ((gradientSize * 1.2 * Math.sin(alpha)) / width) *
                              100,
                            ((gradientSize * 1.2 * Math.cos(alpha)) / height) *
                              100
                          );

                          if (!left)
                            gradientEndPointB.x = 100 - gradientEndPointB.x;
                          if (!top)
                            gradientEndPointB.y = 100 - gradientEndPointB.y;
                        }
                      }

                      tr.x = Math.round(tr.x);
                      tr.y = Math.round(tr.y);

                      return true;
                    },
                    transform = function (tr, c, x, a) {
                      var f = ["0", "auto"],
                        mvW = ((width - h) * x[0]) / 100,
                        mvH = ((height - h) * x[1]) / 100,
                        cssA = {
                          left: f[c[0]],
                          top: f[c[1]],
                          right: f[c[2]],
                          bottom: f[c[3]],
                        },
                        cssB = {},
                        aliasingFk = a != 90 && a != -90 ? (left ? -1 : 1) : 0,
                        origin = x[0] + "% " + x[1] + "%";

                      that
                        .css(cssA)
                        .transform(
                          rotate(a) + translate(tr.x + aliasingFk, tr.y, ac),
                          origin
                        );

                      data.fpage
                        .css(cssA)
                        .transform(
                          rotate(a) +
                            translate(
                              tr.x + df.x - mv.x - (width * x[0]) / 100,
                              tr.y + df.y - mv.y - (height * x[1]) / 100,
                              ac
                            ) +
                            rotate((180 / a - 2) * a),
                          origin
                        );

                      data.wrapper.transform(
                        translate(-tr.x + mvW - aliasingFk, -tr.y + mvH, ac) +
                          rotate(-a),
                        origin
                      );

                      data.fwrapper.transform(
                        translate(-tr.x + mv.x + mvW, -tr.y + mv.y + mvH, ac) +
                          rotate(-a),
                        origin
                      );

                      if (turnData.opts.gradients) {
                        if (x[0])
                          gradientEndPointA.x = 100 - gradientEndPointA.x;

                        if (x[1])
                          gradientEndPointA.y = 100 - gradientEndPointA.y;

                        cssB["box-shadow"] =
                          "0 0 20px rgba(0,0,0," + 0.5 * shadowVal + ")";
                        folding.css(cssB);

                        gradient(
                          data.ashadow,
                          point2D(left ? 100 : 0, top ? 0 : 100),
                          point2D(gradientEndPointA.x, gradientEndPointA.y),
                          [
                            [gradientStartVal, "rgba(0,0,0,0)"],
                            [
                              (1 - gradientStartVal) * 0.8 + gradientStartVal,
                              "rgba(0,0,0," + 0.2 * gradientOpacity + ")",
                            ],
                            [
                              1,
                              "rgba(255,255,255," + 0.2 * gradientOpacity + ")",
                            ],
                          ],
                          3,
                          alpha
                        );

                        if (flipMethods._backGradient.call(that))
                          gradient(
                            data.bshadow,
                            point2D(left ? 0 : 100, top ? 0 : 100),
                            point2D(gradientEndPointB.x, gradientEndPointB.y),
                            [
                              [0.6, "rgba(0,0,0,0)"],
                              [
                                0.8,
                                "rgba(0,0,0," + 0.3 * gradientOpacity + ")",
                              ],
                              [1, "rgba(0,0,0,0)"],
                            ],

                            3
                          );
                      }
                    };

                  switch (point.corner) {
                    case "l":
                      break;
                    case "r":
                      break;
                    case "tl":
                      point.x = Math.max(point.x, 1);
                      compute();
                      transform(tr, [1, 0, 0, 1], [100, 0], a);
                      break;
                    case "tr":
                      point.x = Math.min(point.x, width) - 1;
                      compute();
                      transform(point2D(-tr.x, tr.y), [0, 0, 0, 1], [0, 0], -a);
                      break;
                    case "bl":
                      point.x = Math.max(point.x, 1);
                      compute();
                      transform(
                        point2D(tr.x, -tr.y),
                        [1, 1, 0, 0],
                        [100, 100],
                        -a
                      );
                      break;
                    case "br":
                      point.x = Math.min(point.x, width - 1);
                      compute();
                      transform(
                        point2D(-tr.x, -tr.y),
                        [0, 1, 1, 0],
                        [0, 100],
                        a
                      );
                      break;
                  }

                  break;
              }

              data.point = point;
            },

            _moveFoldingPage: function (move) {
              var data = this.data().f;

              if (!data) return;

              var turn = data.opts.turn,
                turnData = turn.data(),
                place = turnData.pagePlace;

              if (move) {
                var nextPage = data.opts.next;

                if (place[nextPage] != data.opts.page) {
                  if (data.folding)
                    flipMethods._moveFoldingPage.call(this, false);

                  var folding = flipMethods._foldingPage.call(this);

                  folding.appendTo(data.fpage);
                  place[nextPage] = data.opts.page;
                  data.folding = nextPage;
                }

                turn.turn("update");
              } else {
                if (data.folding) {
                  if (turnData.pages[data.folding]) {
                    // If we have flip available

                    var flipData = turnData.pages[data.folding].data().f;

                    turnData.pageObjs[data.folding].appendTo(flipData.wrapper);
                  } else if (turnData.pageWrap[data.folding]) {
                    // If we have the pageWrapper

                    turnData.pageObjs[data.folding].appendTo(
                      turnData.pageWrap[data.folding]
                    );
                  }

                  if (data.folding in place) {
                    place[data.folding] = data.folding;
                  }

                  delete data.folding;
                }
              }
            },

            _showFoldedPage: function (c, animate) {
              var folding = flipMethods._foldingPage.call(this),
                dd = this.data(),
                data = dd.f,
                visible = data.visible;

              if (folding) {
                if (!visible || !data.point || data.point.corner != c.corner) {
                  var corner =
                    data.status == "hover" ||
                    data.status == "peel" ||
                    data.opts.turn.data().mouseAction
                      ? c.corner
                      : null;

                  visible = false;

                  if (
                    trigger("start", this, [data.opts, corner]) == "prevented"
                  )
                    return false;
                }

                if (animate) {
                  var that = this,
                    point =
                      data.point && data.point.corner == c.corner
                        ? data.point
                        : flipMethods._c.call(this, c.corner, 1);

                  this.animatef({
                    from: [point.x, point.y],
                    to: [c.x, c.y],
                    duration: 500,
                    frame: function (v) {
                      c.x = Math.round(v[0]);
                      c.y = Math.round(v[1]);
                      flipMethods._fold.call(that, c);
                    },
                  });
                } else {
                  flipMethods._fold.call(this, c);

                  if (dd.effect && !dd.effect.turning) this.animatef(false);
                }

                if (!visible) {
                  switch (data.effect) {
                    case "hard":
                      data.visible = true;
                      flipMethods._moveFoldingPage.call(this, true);
                      data.fpage.show();
                      if (data.opts.shadows) data.bshadow.show();

                      break;
                    case "sheet":
                      data.visible = true;
                      data.fparent.show().data().flips++;
                      flipMethods._moveFoldingPage.call(this, true);
                      data.fwrapper.show();
                      if (data.bshadow) data.bshadow.show();

                      break;
                  }
                }

                return true;
              }

              return false;
            },

            hide: function () {
              var data = this.data().f,
                turnData = data.opts.turn.data(),
                folding = flipMethods._foldingPage.call(this);

              switch (data.effect) {
                case "hard":
                  if (turnData.opts.gradients) {
                    data.bshadowLoc = 0;
                    data.bshadow.remove();
                    data.ashadow.hide();
                  }

                  data.wrapper.transform("");
                  data.fpage.hide();

                  break;
                case "sheet":
                  if (--data.fparent.data().flips === 0) data.fparent.hide();

                  this.css({
                    left: 0,
                    top: 0,
                    right: "auto",
                    bottom: "auto",
                  }).transform("");

                  data.wrapper.transform("");

                  data.fwrapper.hide();

                  if (data.bshadow) data.bshadow.hide();

                  folding.transform("");

                  break;
              }

              data.visible = false;

              return this;
            },

            hideFoldedPage: function (animate) {
              var data = this.data().f;

              if (!data.point) return;

              var that = this,
                p1 = data.point,
                hide = function () {
                  data.point = null;
                  data.status = "";
                  that.flip("hide");
                  that.trigger("end", [data.opts, false]);
                };

              if (animate) {
                var p4 = flipMethods._c.call(this, p1.corner),
                  top = p1.corner.substr(0, 1) == "t",
                  delta = top
                    ? Math.min(0, p1.y - p4.y) / 2
                    : Math.max(0, p1.y - p4.y) / 2,
                  p2 = point2D(p1.x, p1.y + delta),
                  p3 = point2D(p4.x, p4.y - delta);

                this.animatef({
                  from: 0,
                  to: 1,
                  frame: function (v) {
                    var np = bezier(p1, p2, p3, p4, v);
                    p1.x = np.x;
                    p1.y = np.y;
                    flipMethods._fold.call(that, p1);
                  },
                  complete: hide,
                  duration: 800,
                  hiding: true,
                });
              } else {
                this.animatef(false);
                hide();
              }
            },

            turnPage: function (corner) {
              var that = this,
                data = this.data().f,
                turnData = data.opts.turn.data();

              corner = {
                corner: data.corner
                  ? data.corner.corner
                  : corner || flipMethods._cAllowed.call(this)[0],
              };

              var p1 =
                  data.point ||
                  flipMethods._c.call(
                    this,
                    corner.corner,
                    data.opts.turn ? turnData.opts.elevation : 0
                  ),
                p4 = flipMethods._c2.call(this, corner.corner);

              this.trigger("flip").animatef({
                from: 0,
                to: 1,
                frame: function (v) {
                  var np = bezier(p1, p1, p4, p4, v);
                  corner.x = np.x;
                  corner.y = np.y;
                  flipMethods._showFoldedPage.call(that, corner);
                },
                complete: function () {
                  that.trigger("end", [data.opts, true]);
                },
                duration: turnData.opts.duration,
                turning: true,
              });

              data.corner = null;
            },

            moving: function () {
              return "effect" in this.data();
            },

            isTurning: function () {
              return this.flip("moving") && this.data().effect.turning;
            },

            corner: function () {
              return this.data().f.corner;
            },

            _eventStart: function (e) {
              var data = this.data().f,
                turn = data.opts.turn;

              if (
                !data.corner &&
                !data.disabled &&
                !this.flip("isTurning") &&
                data.opts.page == turn.data().pagePlace[data.opts.page]
              ) {
                data.corner = flipMethods._isIArea.call(this, e);

                if (data.corner && flipMethods._foldingPage.call(this)) {
                  this.trigger("pressed", [data.point]);
                  flipMethods._showFoldedPage.call(this, data.corner);

                  return false;
                } else data.corner = null;
              }
            },

            _eventMove: function (e) {
              var data = this.data().f;

              if (!data.disabled) {
                e = isTouch ? e.originalEvent.touches : [e];

                if (data.corner) {
                  var pos = data.parent.offset();
                  data.corner.x = e[0].pageX - pos.left;
                  data.corner.y = e[0].pageY - pos.top;
                  flipMethods._showFoldedPage.call(this, data.corner);
                } else if (
                  data.hover &&
                  !this.data().effect &&
                  this.is(":visible")
                ) {
                  var point = flipMethods._isIArea.call(this, e[0]);

                  if (point) {
                    if (
                      (data.effect == "sheet" && point.corner.length == 2) ||
                      data.effect == "hard"
                    ) {
                      data.status = "hover";
                      var origin = flipMethods._c.call(
                        this,
                        point.corner,
                        data.opts.cornerSize / 2
                      );
                      point.x = origin.x;
                      point.y = origin.y;
                      flipMethods._showFoldedPage.call(this, point, true);
                    }
                  } else {
                    if (data.status == "hover") {
                      data.status = "";
                      flipMethods.hideFoldedPage.call(this, true);
                    }
                  }
                }
              }
            },

            _eventEnd: function () {
              var data = this.data().f,
                corner = data.corner;

              if (!data.disabled && corner) {
                if (
                  trigger("released", this, [data.point || corner]) !=
                  "prevented"
                ) {
                  flipMethods.hideFoldedPage.call(this, true);
                }
              }

              data.corner = null;
            },

            disable: function (disable) {
              flipMethods.setData.call(this, { disabled: disable });
              return this;
            },

            hover: function (hover) {
              flipMethods.setData.call(this, { hover: hover });
              return this;
            },

            peel: function (corner, animate) {
              var data = this.data().f;

              if (corner) {
                if ($.inArray(corner, corners.all) == -1)
                  throw turnError("Corner " + corner + " is not permitted");

                if ($.inArray(corner, flipMethods._cAllowed.call(this)) != -1) {
                  var point = flipMethods._c.call(
                    this,
                    corner,
                    data.opts.cornerSize / 2
                  );

                  data.status = "peel";

                  flipMethods._showFoldedPage.call(
                    this,
                    {
                      corner: corner,
                      x: point.x,
                      y: point.y,
                    },
                    animate
                  );
                }
              } else {
                data.status = "";

                flipMethods.hideFoldedPage.call(this, animate);
              }

              return this;
            },
          };

        // Processes classes

        function dec(that, methods, args) {
          if (!args[0] || typeof args[0] == "object")
            return methods.init.apply(that, args);
          else if (methods[args[0]])
            return methods[args[0]].apply(
              that,
              Array.prototype.slice.call(args, 1)
            );
          else throw turnError(args[0] + " is not a method or property");
        }

        // Attributes for a layer

        function divAtt(top, left, zIndex, overf) {
          return {
            css: {
              position: "absolute",
              top: top,
              left: left,
              overflow: overf || "hidden",
              zIndex: zIndex || "auto",
            },
          };
        }

        // Gets a 2D point from a bezier curve of four points

        function bezier(p1, p2, p3, p4, t) {
          var a = 1 - t,
            b = a * a * a,
            c = t * t * t;

          return point2D(
            Math.round(
              b * p1.x + 3 * t * a * a * p2.x + 3 * t * t * a * p3.x + c * p4.x
            ),
            Math.round(
              b * p1.y + 3 * t * a * a * p2.y + 3 * t * t * a * p3.y + c * p4.y
            )
          );
        }

        // Converts an angle from degrees to radians

        function rad(degrees) {
          return (degrees / 180) * PI;
        }

        // Converts an angle from radians to degrees

        function deg(radians) {
          return (radians / PI) * 180;
        }

        // Gets a 2D point

        function point2D(x, y) {
          return { x: x, y: y };
        }

        // Webkit 534.3 on Android wrongly repaints elements that use overflow:hidden + rotation

        function rotationAvailable() {
          var parts;

          if ((parts = /AppleWebkit\/([0-9\.]+)/i.exec(navigator.userAgent))) {
            var webkitVersion = parseFloat(parts[1]);
            return webkitVersion > 534.3;
          } else {
            return true;
          }
        }

        // Returns the traslate value

        function translate(x, y, use3d) {
          return has3d && use3d
            ? " translate3d(" + x + "px," + y + "px, 0px) "
            : " translate(" + x + "px, " + y + "px) ";
        }

        // Returns the rotation value

        function rotate(degrees) {
          return " rotate(" + degrees + "deg) ";
        }

        // Checks if a property belongs to an object

        function has(property, object) {
          return Object.prototype.hasOwnProperty.call(object, property);
        }

        // Gets the CSS3 vendor prefix

        function getPrefix() {
          var vendorPrefixes = ["Moz", "Webkit", "Khtml", "O", "ms"],
            len = vendorPrefixes.length,
            vendor = "";

          while (len--)
            if (vendorPrefixes[len] + "Transform" in document.body.style)
              vendor = "-" + vendorPrefixes[len].toLowerCase() + "-";

          return vendor;
        }

        // Detects the transitionEnd Event

        function getTransitionEnd() {
          var t,
            el = document.createElement("fakeelement"),
            transitions = {
              transition: "transitionend",
              OTransition: "oTransitionEnd",
              MSTransition: "transitionend",
              MozTransition: "transitionend",
              WebkitTransition: "webkitTransitionEnd",
            };

          for (t in transitions) {
            if (el.style[t] !== undefined) {
              return transitions[t];
            }
          }
        }

        // Gradients

        function gradient(obj, p0, p1, colors, numColors) {
          var j,
            cols = [];

          if (vendor == "-webkit-") {
            for (j = 0; j < numColors; j++)
              cols.push(
                "color-stop(" + colors[j][0] + ", " + colors[j][1] + ")"
              );

            obj.css({
              "background-image":
                "-webkit-gradient(linear, " +
                p0.x +
                "% " +
                p0.y +
                "%," +
                p1.x +
                "% " +
                p1.y +
                "%, " +
                cols.join(",") +
                " )",
            });
          } else {
            p0 = {
              x: (p0.x / 100) * obj.width(),
              y: (p0.y / 100) * obj.height(),
            };
            p1 = {
              x: (p1.x / 100) * obj.width(),
              y: (p1.y / 100) * obj.height(),
            };

            var dx = p1.x - p0.x,
              dy = p1.y - p0.y,
              angle = Math.atan2(dy, dx),
              angle2 = angle - Math.PI / 2,
              diagonal =
                Math.abs(obj.width() * Math.sin(angle2)) +
                Math.abs(obj.height() * Math.cos(angle2)),
              gradientDiagonal = Math.sqrt(dy * dy + dx * dx),
              corner = point2D(
                p1.x < p0.x ? obj.width() : 0,
                p1.y < p0.y ? obj.height() : 0
              ),
              slope = Math.tan(angle),
              inverse = -1 / slope,
              x =
                (inverse * corner.x - corner.y - slope * p0.x + p0.y) /
                (inverse - slope),
              c = { x: x, y: inverse * x - inverse * corner.x + corner.y },
              segA = Math.sqrt(
                Math.pow(c.x - p0.x, 2) + Math.pow(c.y - p0.y, 2)
              );

            for (j = 0; j < numColors; j++)
              cols.push(
                " " +
                  colors[j][1] +
                  " " +
                  ((segA + gradientDiagonal * colors[j][0]) * 100) / diagonal +
                  "%"
              );

            obj.css({
              "background-image":
                vendor +
                "linear-gradient(" +
                -angle +
                "rad," +
                cols.join(",") +
                ")",
            });
          }
        }

        // Triggers an event

        function trigger(eventName, context, args) {
          var event = $.Event(eventName);
          context.trigger(event, args);
          if (event.isDefaultPrevented()) return "prevented";
          else if (event.isPropagationStopped()) return "stopped";
          else return "";
        }

        // JS Errors

        function turnError(message) {
          function TurnJsError(message) {
            this.name = "TurnJsError";
            this.message = message;
          }

          TurnJsError.prototype = new Error();
          TurnJsError.prototype.constructor = TurnJsError;
          return new TurnJsError(message);
        }

        // Find the offset of an element ignoring its transformation

        function findPos(obj) {
          var offset = { top: 0, left: 0 };

          do {
            offset.left += obj.offsetLeft;
            offset.top += obj.offsetTop;
          } while ((obj = obj.offsetParent));

          return offset;
        }

        // Checks if there's hard page compatibility
        // IE9 is the only browser that does not support hard pages

        function hasHardPage() {
          return navigator.userAgent.indexOf("MSIE 9.0") == -1;
        }

        // Request an animation

        window.requestAnim = (function () {
          return (
            window.requestAnimationFrame ||
            window.webkitRequestAnimationFrame ||
            window.mozRequestAnimationFrame ||
            window.oRequestAnimationFrame ||
            window.msRequestAnimationFrame ||
            function (callback) {
              window.setTimeout(callback, 1000 / 60);
            }
          );
        })();

        // Extend $.fn

        $.extend($.fn, {
          flip: function () {
            return dec($(this[0]), flipMethods, arguments);
          },

          turn: function () {
            return dec($(this[0]), turnMethods, arguments);
          },

          transform: function (transform, origin) {
            var properties = {};

            if (origin) properties[vendor + "transform-origin"] = origin;

            properties[vendor + "transform"] = transform;

            return this.css(properties);
          },

          animatef: function (point) {
            var data = this.data();

            if (data.effect) data.effect.stop();

            if (point) {
              if (!point.to.length) point.to = [point.to];
              if (!point.from.length) point.from = [point.from];

              var diff = [],
                len = point.to.length,
                animating = true,
                that = this,
                time = new Date().getTime(),
                frame = function () {
                  if (!data.effect || !animating) return;

                  var v = [],
                    timeDiff = Math.min(
                      point.duration,
                      new Date().getTime() - time
                    );

                  for (var i = 0; i < len; i++)
                    v.push(
                      data.effect.easing(
                        1,
                        timeDiff,
                        point.from[i],
                        diff[i],
                        point.duration
                      )
                    );

                  point.frame(len == 1 ? v[0] : v);

                  if (timeDiff == point.duration) {
                    delete data["effect"];
                    that.data(data);
                    if (point.complete) point.complete();
                  } else {
                    window.requestAnim(frame);
                  }
                };

              for (var i = 0; i < len; i++)
                diff.push(point.to[i] - point.from[i]);

              data.effect = $.extend(
                {
                  stop: function () {
                    animating = false;
                  },
                  easing: function (x, t, b, c, data) {
                    return c * Math.sqrt(1 - (t = t / data - 1) * t) + b;
                  },
                },
                point
              );

              this.data(data);

              frame();
            } else {
              delete data["effect"];
            }
          },
        });

        // Export some globals

        $.isTouch = isTouch;
        $.mouseEvents = mouseEvents;
        $.cssPrefix = getPrefix;
        $.cssTransitionEnd = getTransitionEnd;
        $.findPos = findPos;
      })(jQuery);

      $(window).ready(function () {
        $(".pages").turn({
          duration: 1500,
          width: 900,
          height: 705,
          //  acceleration: true,
          //  display: 'single',
          // autoCenter: true,
          turnCorners: "bl,br",
          elevation: 300,
          when: {
            turned: function (e, page) {
              console.log("Current view: ", $(this).turn("view"));
            },
          },
        });
      });
    </script>
  </body>
</html>
